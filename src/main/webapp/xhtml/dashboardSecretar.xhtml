<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Dashboard Secretar</title>
    <h:outputStylesheet library="default" name="style.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</h:head>

<h:body>
    <div id="page-container">
        <p:growl id="growl" showDetail="true" life="4000" skipDetailIfEqualsSummary="true"/>

        <div id="top-bar">
            <div class="app-title">
                <i class="pi pi-briefcase" style="font-size: 1.5rem; margin-right: 10px;"></i>
                Dashboard Secretar
            </div>
            <div class="user-status">
                <h:form>
                    <span>Bun venit, #{dashboardSecretarBean.loggedInUser.username}!</span>
                    <p:commandButton value="Delogare" action="#{loginBean.doLogout}" icon="pi pi-sign-out" styleClass="ui-button-warning"/>
                </h:form>
            </div>
        </div>

        <div id="content">
            <h:form id="orgForm">
                <p:panel id="panelOrganizatie" header="Datele Organizației" toggleable="true">
                    <p:outputPanel id="organizatieOutputPanel">
                        <p:outputPanel rendered="#{!dashboardSecretarBean.editModeOrganizatie}">
                            <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank">
                                <h:outputText value="Nume Organizație:"/><h:outputText value="#{dashboardSecretarBean.currentOrganizatie.nume}" style="font-weight:bold;"/>
                                <h:outputText value="Cod Fiscal:"/><h:outputText value="#{dashboardSecretarBean.currentOrganizatie.cif}" style="font-weight:bold;"/>
                                <h:outputText value="Email Contact:"/><h:outputText value="#{dashboardSecretarBean.currentOrganizatie.mail}" style="font-weight:bold;"/>
                                <h:outputText value="Adresă Sediu:"/><h:outputText value="#{dashboardSecretarBean.currentOrganizatie.adresa}" style="font-weight:bold;"/>
                            </p:panelGrid>
                            <div class="mt-3">
                                <p:commandButton value="Editează Datele" icon="pi pi-pencil"
                                                 actionListener="#{dashboardSecretarBean.activeazaModEditareOrganizatie}"
                                                 update=":orgForm:organizatieOutputPanel"/>
                            </div>
                        </p:outputPanel>

                        <p:outputPanel rendered="#{dashboardSecretarBean.editModeOrganizatie}">
                            <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank ui-fluid">
                                <p:outputLabel for="orgName" value="Nume Organizație:"/><p:inputText id="orgName" value="#{dashboardSecretarBean.currentOrganizatie.nume}" required="true"/>
                                <p:outputLabel for="orgCif" value="Cod Fiscal:"/><p:inputText id="orgCif" value="#{dashboardSecretarBean.currentOrganizatie.cif}" required="true"/>
                                <p:outputLabel for="orgMail" value="Email Contact:"/><p:inputText id="orgMail" value="#{dashboardSecretarBean.currentOrganizatie.mail}" required="true"/>
                                <p:outputLabel for="orgAddress" value="Adresă Sediu:"/><p:inputText id="orgAddress" value="#{dashboardSecretarBean.currentOrganizatie.adresa}" required="true"/>
                            </p:panelGrid>
                            <div class="mt-3">
                                <p:commandButton value="Salvează Modificări" icon="pi pi-save"
                                                 actionListener="#{dashboardSecretarBean.salveazaDetaliiOrganizatie}"
                                                 update=":orgForm:organizatieOutputPanel :growl"/>
                                <p:commandButton value="Anulează" icon="pi pi-times"
                                                 actionListener="#{dashboardSecretarBean.anuleazaEditareOrganizatie}"
                                                 process="@this" immediate="true"
                                                 update=":orgForm:organizatieOutputPanel"
                                                 styleClass="ui-button-secondary" style="margin-left: 5px;"/>
                            </div>
                        </p:outputPanel>
                    </p:outputPanel>
                </p:panel>
            </h:form>
            <br/>

            <h:form id="mainForm">
                <p:panel id="departmentManagementPanel" header="Management Departamente" toggleable="true" collapsed="true">
                    <p:commandButton value="Adaugă Departament Nou" icon="pi pi-plus" actionListener="#{dashboardSecretarBean.deschideDialogDepartamentNou}" oncomplete="PF('manageDepartmentDialog').show()" update=":dialogsForm:manageDepartmentForm" styleClass="ui-button-outlined ui-button-success mb-3"/>
                    <p:dataTable id="departmentsTable" var="dept" value="#{dashboardSecretarBean.departmentList}" emptyMessage="Niciun departament definit." rows="5" paginator="true" paginatorPosition="bottom">
                        <p:column headerText="Nume Departament" sortBy="#{dept.nume}"><h:outputText value="#{dept.nume}"/></p:column>
                        <p:column headerText="Coordonator" sortBy="#{dept.coordonator.numeComplet}"><h:outputText value="#{dept.coordonator.numeComplet}" rendered="#{not empty dept.coordonator}"/><h:outputText value="-" rendered="#{empty dept.coordonator}"/></p:column>
                        <p:column style="width:10rem; text-align: center">
                            <p:commandButton icon="pi pi-pencil" title="Editează" oncomplete="PF('manageDepartmentDialog').show()" update=":dialogsForm:manageDepartmentForm" styleClass="ui-button-info rounded-button" style="margin-right: 5px;"><f:setPropertyActionListener value="#{dept}" target="#{dashboardSecretarBean.selectedDepartament}"/></p:commandButton>
                            <p:commandButton icon="pi pi-trash" title="Șterge" actionListener="#{dashboardSecretarBean.stergeDepartament(dept)}" update=":mainForm:departmentManagementPanel :growl" styleClass="ui-button-danger rounded-button"><p:confirm header="Confirmare" message="Ești sigur că vrei să ștergi departamentul '#{dept.nume}'?" icon="pi pi-exclamation-triangle"/></p:commandButton>
                        </p:column>
                    </p:dataTable>
                </p:panel>
                <br/>

                <p:panel header="Generare Rapoarte" toggleable="true" collapsed="true">
                    <p:outputPanel id="reportPanel">
                        <div class="ui-grid ui-fluid">
                            <div class="ui-g-12 ui-md-6" style="display: flex; align-items: center;">
                                <p:outputLabel value="Voluntar selectat:" style="font-weight: bold;"/>
                                <h:outputText value=" #{dashboardSecretarBean.selectedVolunteerForReports.numeComplet}" rendered="#{not empty dashboardSecretarBean.selectedVolunteerForReports}" style="margin-left:10px;"/>
                                <h:outputText value=" Niciun voluntar selectat" rendered="#{empty dashboardSecretarBean.selectedVolunteerForReports}" style="margin-left:10px; font-style:italic;"/>
                            </div>
                            <div class="ui-g-12 ui-md-3">
                                <p:commandButton value="Trimite Certificat" icon="pi pi-file-pdf"
                                                 actionListener="#{dashboardSecretarBean.trimiteCertificatPeEmail}"
                                                 process="@form"
                                                 update=":growl"
                                                 disabled="#{empty dashboardSecretarBean.selectedVolunteerForReports}"/>
                            </div>
                            <div class="ui-g-12 ui-md-3">
                                <p:commandButton value="Trimite Raport Activitate" icon="pi pi-chart-bar"
                                                 actionListener="#{dashboardSecretarBean.trimiteRaportActivitatePeEmail}"
                                                 process="@form"
                                                 update=":growl"
                                                 disabled="#{empty dashboardSecretarBean.selectedVolunteerForReports}"/>
                            </div>
                        </div>
                    </p:outputPanel>
                </p:panel>
                <br/>

                <p:panel header="Management Voluntari">
                    <p:toolbar>
                        <p:toolbarGroup>
                            <p:inputText value="#{dashboardSecretarBean.searchKeyword}" placeholder="Caută după nume, prenume, email..."/>
                            <p:commandButton value="Caută" actionListener="#{dashboardSecretarBean.cautaVoluntari}" update=":mainForm:volunteerTabs" icon="pi pi-search"/>
                            <p:commandButton value="Resetează" actionListener="#{dashboardSecretarBean.incarcaDateleInitiale}" update=":mainForm" icon="pi pi-refresh" styleClass="ui-button-outlined"/>
                        </p:toolbarGroup>
                    </p:toolbar>

                    <p:tabView id="volunteerTabs">
                    </p:tabView>
                </p:panel>
            </h:form>
        </div>

        <div id="footer">Corgi App &#169; 2024</div>
    </div>

    <h:form id="dialogsForm">
    </h:form>
</h:body>
</html>