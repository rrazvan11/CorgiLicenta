<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:o="http://omnifaces.org/ui">

<h:head>
    <title>Dashboard Secretar - #{dashboardSecretarBean.currentOrganizatie.nume}</title>
    <h:outputStylesheet library="default" name="style.css" />
</h:head>

<h:body>
    <div id="page-container">
        <h:form id="form">
            <p:growl id="growl" showDetail="true" life="6000"/>

            <p:panel header="Detalii Organizație" style="margin-bottom: 20px;">
                <p:panelGrid columns="3" layout="grid" styleClass="ui-panelgrid-blank"
                             columnClasses="ui-grid-col-2,ui-grid-col-8,ui-grid-col-2">
                    <p:outputLabel for="numeOrg" value="Nume Organizație:" />
                    <p:inputText id="numeOrg" value="#{dashboardSecretarBean.currentOrganizatie.nume}"
                                 disabled="#{!dashboardSecretarBean.editModeOrganizatie}" style="width:100%"/>
                    <p:message for="numeOrg" />

                    <p:outputLabel for="adresaOrg" value="Adresă:" />
                    <p:inputText id="adresaOrg" value="#{dashboardSecretarBean.currentOrganizatie.adresa}"
                                 disabled="#{!dashboardSecretarBean.editModeOrganizatie}" style="width:100%"/>
                    <p:message for="adresaOrg" />

                    <p:outputLabel for="emailOrg" value="Email:" />
                    <p:inputText id="emailOrg" value="#{dashboardSecretarBean.currentOrganizatie.mail}"
                                 disabled="#{!dashboardSecretarBean.editModeOrganizatie}" style="width:100%"/>
                    <p:message for="emailOrg" />

                    <p:outputLabel for="cifOrg" value="CIF:" />
                    <p:inputText id="cifOrg" value="#{dashboardSecretarBean.currentOrganizatie.cif}"
                                 disabled="true" style="width:100%"/>
                    <p:message for="cifOrg" />
                </p:panelGrid>

                <f:facet name="footer">
                    <p:commandButton value="Editează" icon="pi pi-pencil"
                                     actionListener="#{dashboardSecretarBean.activeazaModEditareOrganizatie}"
                                     update="@form" rendered="#{!dashboardSecretarBean.editModeOrganizatie}" />

                    <p:commandButton value="Salvează" icon="pi pi-save"
                                     actionListener="#{dashboardSecretarBean.salveazaDetaliiOrganizatie}"
                                     update="@form" rendered="#{dashboardSecretarBean.editModeOrganizatie}" styleClass="ui-button-success"/>

                    <p:commandButton value="Anulează" icon="pi pi-times"
                                     actionListener="#{dashboardSecretarBean.anuleazaEditareOrganizatie}"
                                     update="@form" rendered="#{dashboardSecretarBean.editModeOrganizatie}" immediate="true" styleClass="ui-button-secondary"/>
                </f:facet>
            </p:panel>

            <p:panel header="Management Voluntari" style="margin-bottom: 20px;">
                <p:tabView>
                    <p:tab title="Activi (#{dashboardSecretarBean.voluntariActivi.size()})">
                        <p:dataTable value="#{dashboardSecretarBean.voluntariActivi}" var="vol" styleClass="admin-volunteer-table" paginator="true" rows="5">
                            <p:column headerText="Nume Complet">#{vol.numeComplet}</p:column>
                            <p:column headerText="Departament">#{vol.departament.nume}</p:column>
                            <p:column headerText="Status Membru">
                                <p:selectOneMenu value="#{vol.status}" converter="o:genericEnumConverter">
                                    <f:selectItems value="#{dashboardSecretarBean.statusValues}" var="s" itemLabel="#{s.name()}" itemValue="#{s}" />
                                    <p:ajax listener="#{dashboardSecretarBean.laSchimbareaStatusului(vol)}" update="@form:growl"/>
                                </p:selectOneMenu>
                            </p:column>
                            <p:column headerText="Acțiuni">
                                <p:commandButton icon="pi pi-ban" title="Dezactivează Cont" actionListener="#{dashboardSecretarBean.comutaStareCont(vol)}" update="@form" styleClass="ui-button-warning" />
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Colaboratori (#{dashboardSecretarBean.voluntariColaboratori.size()})">
                        <p:dataTable value="#{dashboardSecretarBean.voluntariColaboratori}" var="vol" styleClass="admin-volunteer-table" paginator="true" rows="5">
                            <p:column headerText="Nume Complet">#{vol.numeComplet}</p:column>
                            <p:column headerText="Departament">#{vol.departament.nume}</p:column>
                            <p:column headerText="Status Membru">
                                <p:selectOneMenu value="#{vol.status}" converter="o:genericEnumConverter">
                                    <f:selectItems value="#{dashboardSecretarBean.statusValues}" var="s" itemLabel="#{s.name()}" itemValue="#{s}" />
                                    <p:ajax listener="#{dashboardSecretarBean.laSchimbareaStatusului(vol)}" update="@form:growl"/>
                                </p:selectOneMenu>
                            </p:column>
                            <p:column headerText="Acțiuni">
                                <p:commandButton icon="pi pi-ban" title="Dezactivează Cont" actionListener="#{dashboardSecretarBean.comutaStareCont(vol)}" update="@form" styleClass="ui-button-warning" />
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Coordonatori (#{dashboardSecretarBean.coordonatori.size()})">
                        <p:dataTable value="#{dashboardSecretarBean.coordonatori}" var="vol" styleClass="admin-volunteer-table" paginator="true" rows="5">
                            <p:column headerText="Nume Complet">#{vol.numeComplet}</p:column>
                            <p:column headerText="Departament Coordonat">#{vol.departament.nume}</p:column>
                            <p:column headerText="Rol">#{vol.user.rol}</p:column>
                            <p:column headerText="Acțiuni">
                                <p:commandButton icon="pi pi-ban" title="Dezactivează Cont" actionListener="#{dashboardSecretarBean.comutaStareCont(vol)}" update="@form" styleClass="ui-button-warning" />
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Nerepartizați (#{dashboardSecretarBean.voluntariNerepartizati.size()})">
                        <p:dataTable value="#{dashboardSecretarBean.voluntariNerepartizati}" var="vol" styleClass="admin-volunteer-table" paginator="true" rows="5">
                            <p:column headerText="Nume Complet">#{vol.numeComplet}</p:column>
                            <p:column headerText="Email">#{vol.user.email}</p:column>
                            <p:column headerText="Repartizează la">
                                <p:selectOneMenu value="#{vol.departament}">
                                    <f:selectItem itemLabel="Selectează Departament" itemValue="#{null}" noSelectionOption="true" />
                                    <f:selectItems value="#{dashboardSecretarBean.departmentList}" var="dept" itemLabel="#{dept.nume}" itemValue="#{dept}" />
                                    <o:converter converterId="omnifaces.SelectItemsConverter" />
                                    <p:ajax listener="#{dashboardSecretarBean.laSchimbareaDepartamentului(vol)}" update="@form"/>
                                </p:selectOneMenu>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Conturi Inactive (#{dashboardSecretarBean.voluntariInactivi.size()})">
                        <p:dataTable value="#{dashboardSecretarBean.voluntariInactivi}" var="vol" styleClass="admin-volunteer-table" paginator="true" rows="5">
                            <p:column headerText="Nume Complet">#{vol.numeComplet}</p:column>
                            <p:column headerText="Email">#{vol.user.email}</p:column>
                            <p:column headerText="Acțiuni">
                                <p:commandButton icon="pi pi-check-circle" title="Reactivează Cont" actionListener="#{dashboardSecretarBean.comutaStareCont(vol)}" update="@form" styleClass="ui-button-success" />
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                </p:tabView>
            </p:panel>

            <p:panel header="Management Departamente și Rapoarte" style="margin-bottom: 20px;">
                <p:dataTable value="#{dashboardSecretarBean.departmentList}" var="dept" paginator="true" rows="5">
                    <p:column headerText="Nume Departament">#{dept.nume}</p:column>
                    <p:column headerText="Descriere">#{dept.descriere}</p:column>
                    <p:column headerText="Coordonator">#{dept.coordonator.numeComplet}</p:column>
                    <p:column headerText="Acțiuni" style="text-align:center">
                        <p:commandButton icon="pi pi-file-pdf" title="Generează Raport PDF"
                                         actionListener="#{dashboardSecretarBean.genereazaSiTrimiteRaportDepartament(dept)}"
                                         ajax="false" styleClass="ui-button-danger" />
                    </p:column>
                </p:dataTable>
            </p:panel>

            <p:panel header="Management Ședințe Generale">
                <p:commandButton value="Începe Foaie de Prezență" icon="pi pi-check-square"
                                 actionListener="#{dashboardSecretarBean.initiazaFoaiePrezenta}"
                                 update="attendancePanel" rendered="#{!dashboardSecretarBean.attendanceMode}"
                                 style="margin-bottom:10px;"/>

                <p:outputPanel id="attendancePanel">
                    <p:outputPanel rendered="#{dashboardSecretarBean.attendanceMode}">
                        <h3>Foaie de Prezență - #{dashboardSecretarBean.sedintaCurenta.dataSedinta.toLocalDate()}</h3>

                        <p:inputTextarea value="#{dashboardSecretarBean.sedintaCurenta.descriere}"
                                         placeholder="Introduceți o scurtă descriere a ședinței (ex: Ședință Generală Aprilie)"
                                         rows="3" style="width:100%; margin-bottom:10px;" />

                        <p:dataTable value="#{dashboardSecretarBean.listaPrezente}" var="prezenta" paginator="true" rows="10">
                            <p:column headerText="Voluntar">
                                <h:outputText value="#{prezenta.voluntar.numeComplet}" />
                            </p:column>
                            <p:column headerText="Departament">
                                <h:outputText value="#{prezenta.voluntar.departament.nume}" />
                            </p:column>
                            <p:column headerText="Status Prezență" style="width: 250px;">
                                <p:selectOneRadio value="#{prezenta.status}" layout="grid" columns="4" converter="o:genericEnumConverter">
                                    <f:selectItems value="#{dashboardSecretarBean.statusPrezentaValues}"
                                                   var="status" itemLabel="#{status.name()}" itemValue="#{status}"/>
                                </p:selectOneRadio>
                            </p:column>
                        </p:dataTable>

                        <p:commandButton value="Salvează Prezența" icon="pi pi-save"
                                         actionListener="#{dashboardSecretarBean.salveazaFoaiePrezenta}"
                                         update="@form" styleClass="ui-button-success" style="margin-top:10px;"/>

                        <p:commandButton value="Anulează" icon="pi pi-times"
                                         actionListener="#{dashboardSecretarBean.anuleazaFoaiePrezenta}"
                                         update="attendancePanel" immediate="true"
                                         styleClass="ui-button-secondary" style="margin-top:10px;"/>
                    </p:outputPanel>
                </p:outputPanel>
            </p:panel>

        </h:form>
    </div>
</h:body>
</html>